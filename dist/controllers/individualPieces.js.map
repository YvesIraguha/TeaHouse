{"version":3,"sources":["../../src/controllers/individualPieces.js"],"names":["Piece","Models","IndividualPieceController","req","res","body","userId","user","id","slug","title","createdPiece","create","status","send","message","individualPiece","params","piece","findOne","where","error","deletedPiece","destroy","updatedPiece","update","returning","query","page","type","individualPieces","findAll","offset","limit","length"],"mappings":"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","sourcesContent":["import Models from \"../../models\";\nimport { generateSlug } from \"../helpers/individualPiece\";\n\nconst { Piece } = Models;\n\nclass IndividualPieceController {\n  static async create(req, res) {\n    const { body } = req;\n    const {\n      user: { id: userId }\n    } = req;\n    const slug = generateSlug(body.title);\n\n    const createdPiece = await Piece.create({ ...body, userId, slug });\n    res.status(201).send({\n      message: \"Resource created successfully\",\n      individualPiece: createdPiece\n    });\n  }\n\n  static async fetchOnePiece(req, res) {\n    const { id } = req.params;\n    const piece = await Piece.findOne({ where: { id } });\n\n    if (piece) {\n      res.status(200).send({\n        message: \"Resource retrieved successfully\",\n        individualPiece: piece\n      });\n    } else {\n      res.status(404).send({ error: \"Resource does not exist\" });\n    }\n  }\n\n  static async deleteOnePiece(req, res) {\n    const { id } = req.params;\n    const deletedPiece = await Piece.destroy({ where: { id } });\n    if (deletedPiece) {\n      res.status(200).send({ message: \"Resource deleted successfully\" });\n    } else {\n      res.status(404).send({ error: \"Resource does not exist\" });\n    }\n  }\n\n  static async updateOnePiece(req, res) {\n    const { id } = req.params;\n    const { body } = req;\n\n    const updatedPiece = await Piece.update(\n      { ...body },\n      { where: { id }, returning: true }\n    );\n\n    if (updatedPiece[0]) {\n      res.status(200).send({\n        message: \"Resource updated successfully\",\n        individualPiece: updatedPiece[1][0]\n      });\n    } else {\n      res.status(404).send({ error: \"Resource does not exist\" });\n    }\n  }\n\n  static async getAll(req, res) {\n    const { page, type } = req.query;\n    const individualPieces = await Piece.findAll({\n      where: { type },\n      offset: (page - 1) * 6,\n      limit: 6\n    });\n    if (individualPieces.length) {\n      return res\n        .status(200)\n        .send({ message: \"Data retrieved successfully\", individualPieces });\n    }\n    res.status(404).send({ error: \"Data not found\" });\n  }\n}\n\nexport default IndividualPieceController;\n"],"file":"individualPieces.js"}